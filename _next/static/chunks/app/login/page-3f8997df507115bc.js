(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{17:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var r=a(5155),s=a(2115),n=a(63),o=a(2544),l=a(6942),i=a(2377),d=a(8519),c=a(508),u=a(9708),m=a(532),h=a(7828),p=a(3998),g=a(5142),f=a(6948),x=a(6444),y=a(854),v=a(5183),b=a(2619),N=a.n(b);let w=i.Ik({username:i.Yj().min(3,"Username phải c\xf3 \xedt nhất 3 k\xfd tự").max(20,"Username tối đa 20 k\xfd tự"),password:i.Yj().min(6,"Mật khẩu phải c\xf3 \xedt nhất 6 k\xfd tự")}),j=()=>{let[e,t]=(0,s.useState)(!1),[a,i]=(0,s.useState)(!1),[b,j]=(0,s.useState)(null),k=(0,n.useRouter)(),{login:S}=(0,y.A)(),{register:C,handleSubmit:I,formState:{errors:R}}=(0,o.mN)({resolver:(0,l.u)(w)}),A=async e=>{i(!0),j(null);try{let t=await v.y1.login(e);t.success&&t.data?(S(t.data.token,t.data.user),k.push("/")):j(t.message||"Đăng nhập thất bại")}catch(e){var t,a;console.error("Login error:",e),j((null==(a=e.response)||null==(t=a.data)?void 0:t.message)||e.message||"Đ\xe3 xảy ra lỗi kh\xf4ng mong muốn")}finally{i(!1)}};return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-white to-cyan-50 p-4",children:(0,r.jsx)("div",{className:"w-full max-w-md animate-fade-in",children:(0,r.jsxs)(f.Zp,{className:"shadow-2xl border-0 bg-white/80 backdrop-blur-sm",children:[(0,r.jsxs)(f.aR,{className:"text-center space-y-4",children:[(0,r.jsx)("div",{className:"mx-auto w-16 h-16 bg-gradient-to-br from-blue-600 to-cyan-600 rounded-full flex items-center justify-center shadow-lg",children:(0,r.jsx)(d.A,{className:"h-8 w-8 text-white"})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(f.ZB,{className:"text-2xl font-bold text-gray-900",children:"Payment Client"}),(0,r.jsx)(f.BT,{className:"text-gray-600",children:"Đăng nhập để truy cập hệ thống thanh to\xe1n"})]})]}),(0,r.jsxs)(f.Wu,{className:"space-y-6",children:[(0,r.jsxs)("form",{onSubmit:I(A),className:"space-y-4",children:[b&&(0,r.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md animate-slide-up",children:(0,r.jsx)("p",{className:"text-sm text-red-800",children:b})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(x.J,{htmlFor:"username",className:"text-sm font-medium text-gray-700",children:"Username"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(c.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,r.jsx)(g.p,{id:"username",type:"text",placeholder:"username",className:"pl-10",...C("username")})]}),R.username&&(0,r.jsx)("p",{className:"text-sm text-red-600",children:R.username.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(x.J,{htmlFor:"password",className:"text-sm font-medium text-gray-700",children:"Mật khẩu"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(u.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,r.jsx)(g.p,{id:"password",type:e?"text":"password",placeholder:"••••••••",className:"pl-10 pr-10",...C("password")}),(0,r.jsx)("button",{type:"button",onClick:()=>t(!e),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",children:e?(0,r.jsx)(m.A,{className:"h-4 w-4"}):(0,r.jsx)(h.A,{className:"h-4 w-4"})})]}),R.password&&(0,r.jsx)("p",{className:"text-sm text-red-600",children:R.password.message})]}),(0,r.jsx)(p.$,{type:"submit",className:"w-full bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white font-medium py-2.5 transition-all duration-200 transform hover:scale-[1.02]",disabled:a,children:a?(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{children:"Đang đăng nhập..."})]}):"Đăng nhập"})]}),(0,r.jsxs)("div",{className:"text-center space-y-3",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Chưa c\xf3 t\xe0i khoản?"," ",(0,r.jsx)(N(),{href:"/register",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Đăng k\xfd ngay"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Hệ thống thanh to\xe1n an to\xe0n • Payment Client Service"})]})]})]})})})}},854:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var r=a(2115),s=a(5380);let n=()=>{let e=(0,r.useContext)(s.c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},2395:(e,t,a)=>{Promise.resolve().then(a.bind(a,17))},3998:(e,t,a)=>{"use strict";a.d(t,{$:()=>d});var r=a(5155),s=a(2115),n=a(6673),o=a(3101),l=a(4269);let i=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:a,variant:s,size:o,asChild:d=!1,...c}=e,u=d?n.DX:"button";return(0,r.jsx)(u,{className:(0,l.cn)(i({variant:s,size:o,className:a})),ref:t,...c})});d.displayName="Button"},4269:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n});var r=a(2821),s=a(5889);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,r.$)(t))}},5142:(e,t,a)=>{"use strict";a.d(t,{p:()=>o});var r=a(5155),s=a(2115),n=a(4269);let o=s.forwardRef((e,t)=>{let{className:a,type:s,...o}=e;return(0,r.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...o})});o.displayName="Input"},5183:(e,t,a)=>{"use strict";a.d(t,{IU:()=>d,MV:()=>i,lc:()=>l,y1:()=>o});var r=a(5125);let s="https://api-client.nroflux.com/api/v1",n=r.A.create({baseURL:s,timeout:1e4,headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{{let t=localStorage.getItem("authToken");t&&(e.headers.Authorization="Bearer ".concat(t))}return e}),n.interceptors.response.use(e=>e,e=>{var t;return(null==(t=e.response)?void 0:t.status)===401&&(localStorage.removeItem("authToken"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)});let o={login:async e=>(await n.post("/auth/login",e)).data,register:async e=>(await n.post("/auth/register",e)).data,getProfile:async()=>(await n.get("/auth/profile")).data,refreshToken:async()=>(await n.post("/auth/refresh")).data},l={getAllItems:async()=>(await n.get("/items")).data,getItemById:async e=>(await n.get("/items/".concat(e))).data},i={createPayment:async e=>(await n.post("/payments",e)).data,createMobileCardPayment:async(e,t)=>{let a={...e,itemId:t};return(await n.post("/payments/mobile-card",a)).data},getMyPayments:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(await n.get("/payments/my",{params:{limit:e,skip:t}})).data},streamPaymentByRefCode:(e,t)=>{let a=null!=t?t:localStorage.getItem("authToken")||"";return new EventSource("".concat(s,"/payments/stream/").concat(encodeURIComponent(e),"?token=").concat(encodeURIComponent(a)))}},d={getUserHistory:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return(await n.get("/transactions/history",{params:{page:e,limit:t}})).data}}},5380:(e,t,a)=>{"use strict";a.d(t,{AuthProvider:()=>o,c:()=>n});var r=a(5155),s=a(2115);let n=(0,s.createContext)(void 0),o=e=>{let{children:t}=e,[a,o]=(0,s.useState)(null),[l,i]=(0,s.useState)(null),[d,c]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{{let e=localStorage.getItem("authToken"),t=localStorage.getItem("user");if(e&&t)try{let a=JSON.parse(t);i(e),o(a)}catch(e){console.error("Error parsing stored user data:",e),localStorage.removeItem("authToken"),localStorage.removeItem("user")}}c(!1)},[]),(0,r.jsx)(n.Provider,{value:{user:a,token:l,isAuthenticated:!!l&&!!a,isLoading:d,login:(e,t)=>{localStorage.setItem("authToken",e),localStorage.setItem("user",JSON.stringify(t)),i(e),o(t)},logout:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("user"),i(null),o(null)}},children:t})}},6444:(e,t,a)=>{"use strict";a.d(t,{J:()=>d});var r=a(5155),s=a(2115),n=a(6554),o=a(3101),l=a(4269);let i=(0,o.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.b,{ref:t,className:(0,l.cn)(i(),a),...s})});d.displayName=n.b.displayName},6948:(e,t,a)=>{"use strict";a.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>i,Zp:()=>o,aR:()=>l});var r=a(5155),s=a(2115),n=a(4269);let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});o.displayName="Card";let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...s})});l.displayName="CardHeader";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});i.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...s})});c.displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter"}},e=>{e.O(0,[125,87,632,465,441,255,358],()=>e(e.s=2395)),_N_E=e.O()}]);